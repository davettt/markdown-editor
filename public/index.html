<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data:;"
    />
    <title>Markdown Editor & Live Previewer</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='5' y='5' width='40' height='90' fill='%23f5f5f5' stroke='%23333' stroke-width='2'/><line x1='12' y1='20' x2='38' y2='20' stroke='%23222' stroke-width='2'/><line x1='12' y1='32' x2='38' y2='32' stroke='%23222' stroke-width='2'/><line x1='12' y1='44' x2='38' y2='44' stroke='%23222' stroke-width='2'/><line x1='12' y1='60' x2='38' y2='60' stroke='%23aaa' stroke-width='1'/><line x1='12' y1='71' x2='38' y2='71' stroke='%23aaa' stroke-width='1'/><rect x='55' y='5' width='40' height='90' fill='%23fff' stroke='%23333' stroke-width='2'/><text x='62' y='28' font-size='16' font-weight='bold' fill='%23333'>âœ“</text><text x='62' y='50' font-size='9' fill='%23666'>HTML</text><text x='62' y='65' font-size='9' fill='%23666'>Out</text></svg>"
      type="image/svg+xml"
    />
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>Markdown Editor & Live Previewer</h1>
        <div class="status" id="status">Ready</div>
      </header>

      <!-- File Control Panel -->
      <div class="control-panel">
        <div class="file-input-group">
          <label for="filePath">File Path:</label>
          <input
            type="text"
            id="filePath"
            placeholder="Enter absolute path to markdown file"
            class="file-input"
          />
        </div>

        <div class="button-group">
          <button id="browseBtn" class="btn btn-primary">Browse Files</button>
          <button id="loadBtn" class="btn btn-primary">Load File</button>
          <button id="saveBtn" class="btn btn-success" disabled>Save File</button>
          <button id="clearBtn" class="btn btn-secondary">Clear</button>
        </div>
      </div>

      <!-- Main Editor Area -->
      <div class="editor-container">
        <!-- Editor Pane -->
        <div class="pane editor-pane">
          <h2>Editor</h2>
          <textarea
            id="editor"
            class="editor"
            placeholder="Paste markdown content or load from file..."
          ></textarea>
        </div>

        <!-- Preview Pane -->
        <div class="pane preview-pane">
          <h2>Preview</h2>
          <div id="preview" class="preview"></div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="footer">
        <p>Local-only markdown editor with live preview. All files stay on your computer.</p>
        <p><a href="https://github.com/davettt/markdown-editor" target="_blank" rel="noopener">View on GitHub</a></p>
      </footer>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="modal hidden">
      <div class="modal-content">
        <h2>Error</h2>
        <p id="errorMessage"></p>
        <button id="closeErrorBtn" class="btn btn-primary">Close</button>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal hidden">
      <div class="modal-content success">
        <h2>Success</h2>
        <p id="successMessage"></p>
        <button id="closeSuccessBtn" class="btn btn-primary">Close</button>
      </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loading" class="loading hidden">
      <div class="spinner"></div>
      <p id="loadingText">Loading...</p>
    </div>

    <!-- File Browser Modal -->
    <div id="fileBrowserModal" class="modal hidden">
      <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
        <h2>Select Markdown File</h2>
        <input
          type="text"
          id="fileSearchInput"
          placeholder="Search files... (e.g., spec, readme)"
          style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--color-border); border-radius: var(--border-radius); margin-bottom: var(--spacing-md); font-family: var(--font-family-base); font-size: 0.875rem;"
        />
        <div id="fileList" style="max-height: 55vh; overflow-y: auto; border: 1px solid var(--color-border); border-radius: var(--border-radius); padding: var(--spacing-md);">
          <p>Loading files...</p>
        </div>
        <div style="display: flex; gap: var(--spacing-md); margin-top: var(--spacing-lg); justify-content: flex-end;">
          <button id="closeBrowserBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
