<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data:;"
    />
    <title>Markdown Editor & Live Previewer</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%2310B981;stop-opacity:1'/><stop offset='100%25' style='stop-color:%23059669;stop-opacity:1'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23grad)'/><path d='M25,30 L25,70 L35,60 L45,70 L45,30 Z' fill='white' opacity='0.9'/><rect x='55' y='35' width='20' height='3' rx='1.5' fill='white' opacity='0.9'/><rect x='55' y='45' width='20' height='3' rx='1.5' fill='white' opacity='0.9'/><rect x='55' y='55' width='15' height='3' rx='1.5' fill='white' opacity='0.9'/><rect x='55' y='65' width='18' height='3' rx='1.5' fill='white' opacity='0.9'/></svg>"
      type="image/svg+xml"
    />
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <div class="header-brand">
          <svg
            class="logo"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 100 100"
            width="40"
            height="40"
          >
            <defs>
              <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color: #10B981; stop-opacity: 1" />
                <stop offset="100%" style="stop-color: #059669; stop-opacity: 1" />
              </linearGradient>
            </defs>
            <rect width="100" height="100" rx="20" fill="url(#logoGrad)" />
            <path d="M25,30 L25,70 L35,60 L45,70 L45,30 Z" fill="white" opacity="0.9" />
            <rect x="55" y="35" width="20" height="3" rx="1.5" fill="white" opacity="0.9" />
            <rect x="55" y="45" width="20" height="3" rx="1.5" fill="white" opacity="0.9" />
            <rect x="55" y="55" width="15" height="3" rx="1.5" fill="white" opacity="0.9" />
            <rect x="55" y="65" width="18" height="3" rx="1.5" fill="white" opacity="0.9" />
          </svg>
          <h1>Markdown Editor & Live Previewer</h1>
        </div>
        <div class="status" id="status">Ready</div>
      </header>

      <!-- File Control Panel -->
      <div class="control-panel">
        <div class="file-input-group">
          <label for="filePath">File Path:</label>
          <input
            type="text"
            id="filePath"
            placeholder="Enter absolute path to markdown file"
            class="file-input"
          />
        </div>

        <div class="button-group">
          <button id="browseBtn" class="btn btn-primary">Browse Files</button>
          <button id="loadBtn" class="btn btn-primary">Load File</button>
          <button id="saveBtn" class="btn btn-success" disabled>Save File</button>
          <button id="clearBtn" class="btn btn-secondary">Clear</button>
        </div>
      </div>

      <!-- Main Editor Area -->
      <div class="editor-container">
        <!-- Editor Pane -->
        <div class="pane editor-pane">
          <h2>Editor</h2>
          <textarea
            id="editor"
            class="editor"
            placeholder="Paste markdown content or load from file..."
          ></textarea>
        </div>

        <!-- Preview Pane -->
        <div class="pane preview-pane">
          <h2>Preview</h2>
          <div id="preview" class="preview"></div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="footer">
        <p>Local-only markdown editor with live preview. All files stay on your computer.</p>
        <p>
          <a href="https://github.com/davettt/markdown-editor" target="_blank" rel="noopener"
            >View on GitHub</a
          >
        </p>
      </footer>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="modal hidden">
      <div class="modal-content">
        <h2>Error</h2>
        <p id="errorMessage"></p>
        <button id="closeErrorBtn" class="btn btn-primary">Close</button>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal hidden">
      <div class="modal-content success">
        <h2>Success</h2>
        <p id="successMessage"></p>
        <button id="closeSuccessBtn" class="btn btn-primary">Close</button>
      </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loading" class="loading hidden">
      <div class="spinner"></div>
      <p id="loadingText">Loading...</p>
    </div>

    <!-- File Browser Modal -->
    <div id="fileBrowserModal" class="modal hidden">
      <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto">
        <h2>Select Markdown File</h2>
        <input
          type="text"
          id="fileSearchInput"
          placeholder="Search files... (e.g., spec, readme)"
          style="
            width: 100%;
            padding: var(--spacing-sm);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            font-family: var(--font-family-base);
            font-size: 0.875rem;
          "
        />
        <div
          id="fileList"
          style="
            max-height: 55vh;
            overflow-y: auto;
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
          "
        >
          <p>Loading files...</p>
        </div>
        <div
          style="
            display: flex;
            gap: var(--spacing-md);
            margin-top: var(--spacing-lg);
            justify-content: flex-end;
          "
        >
          <button id="closeBrowserBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
